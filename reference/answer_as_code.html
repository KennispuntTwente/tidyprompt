<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Instruct LLM to answer a prompt with R code — answer_as_code • tidyprompt</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Instruct LLM to answer a prompt with R code — answer_as_code"><meta name="description" content="This function adds a prompt wrap to a tidyprompt object that instructs the
LLM to answer the prompt with R code. There are various options to customize
the behavior of this prompt wrap, concerning the evaluation of the R code,
the packages that may be used, the objects that already exist in the R
session, and if the console output that should be sent back to the LLM. For
the evaluation of the R code, the 'callr' package is required. Please note:
automatic evaluation of generated R code may be dangerous to your system;
use this function with caution."><meta property="og:description" content="This function adds a prompt wrap to a tidyprompt object that instructs the
LLM to answer the prompt with R code. There are various options to customize
the behavior of this prompt wrap, concerning the evaluation of the R code,
the packages that may be used, the objects that already exist in the R
session, and if the console output that should be sent back to the LLM. For
the evaluation of the R code, the 'callr' package is required. Please note:
automatic evaluation of generated R code may be dangerous to your system;
use this function with caution."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyprompt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/example_usage.html">Example usage</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tjarkvandemerwe/tidyprompt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Instruct LLM to answer a prompt with R code</h1>
      <small class="dont-index">Source: <a href="https://github.com/tjarkvandemerwe/tidyprompt/blob/main/R/answer_as_code.R" class="external-link"><code>R/answer_as_code.R</code></a></small>
      <div class="d-none name"><code>answer_as_code.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function adds a prompt wrap to a tidyprompt object that instructs the
LLM to answer the prompt with R code. There are various options to customize
the behavior of this prompt wrap, concerning the evaluation of the R code,
the packages that may be used, the objects that already exist in the R
session, and if the console output that should be sent back to the LLM. For
the evaluation of the R code, the 'callr' package is required. Please note:
automatic evaluation of generated R code may be dangerous to your system;
use this function with caution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">answer_as_code</span><span class="op">(</span></span>
<span>  <span class="va">prompt</span>,</span>
<span>  add_text <span class="op">=</span> <span class="st">"You must code in the programming language 'R' to answer this prompt."</span>,</span>
<span>  pkgs_to_use <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  evaluate_code <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  evaluation_session <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  list_packages <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  list_objects <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  skim_dataframes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output_as_tool <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"full"</span>, <span class="st">"code"</span>, <span class="st">"console"</span>, <span class="st">"object"</span>, <span class="st">"formatted_output"</span>, <span class="st">"llm_answer"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-prompt">prompt<a class="anchor" aria-label="anchor" href="#arg-prompt"></a></dt>
<dd><p>A character string or a tidyprompt object</p></dd>


<dt id="arg-add-text">add_text<a class="anchor" aria-label="anchor" href="#arg-add-text"></a></dt>
<dd><p>Character string which will be added to the prompt text,
informing the LLM that they must code in R to answer the prompt.</p></dd>


<dt id="arg-pkgs-to-use">pkgs_to_use<a class="anchor" aria-label="anchor" href="#arg-pkgs-to-use"></a></dt>
<dd><p>A character vector of package names that may be used
in the R code that the LLM will generate. If evaluating the R code, these
will be pre-loaded in the R session.</p></dd>


<dt id="arg-evaluate-code">evaluate_code<a class="anchor" aria-label="anchor" href="#arg-evaluate-code"></a></dt>
<dd><p>Logical indicating whether the R code should be
evaluated. If TRUE, the R code will be evaluated in a new R session (
using the 'callr' package).</p></dd>


<dt id="arg-evaluation-session">evaluation_session<a class="anchor" aria-label="anchor" href="#arg-evaluation-session"></a></dt>
<dd><p>A pre-existing r_session object (from the 'callr' package)
to evaluate the R code (e.g., with certain objects loaded). If NULL, a
new r_session object will be created.</p></dd>


<dt id="arg-list-packages">list_packages<a class="anchor" aria-label="anchor" href="#arg-list-packages"></a></dt>
<dd><p>Logical indicating whether the LLM should be informed
about the packages that may be used in the R code (if TRUE, a list of the
loaded packages will be shown in the initial prompt)</p></dd>


<dt id="arg-list-objects">list_objects<a class="anchor" aria-label="anchor" href="#arg-list-objects"></a></dt>
<dd><p>Logical indicating whether the LLM should be informed
about the objects that already exist in the R session (if TRUE, a list of the objects
plus their types will be shown in the initial prompt)</p></dd>


<dt id="arg-skim-dataframes">skim_dataframes<a class="anchor" aria-label="anchor" href="#arg-skim-dataframes"></a></dt>
<dd><p>Logical indicating whether the LLM should be informed
about the structure of dataframes that already exist in the R session (if TRUE,
a skim summary of each dataframe will be shown in the initial prompt)</p></dd>


<dt id="arg-output-as-tool">output_as_tool<a class="anchor" aria-label="anchor" href="#arg-output-as-tool"></a></dt>
<dd><p>Logical indicating whether the console output of the
evaluated R code should be sent back to the LLM, meaning the LLM will use
R code as a tool to formulate an answer to the prompt. If TRUE, the LLM
can decide if they can answer the prompt with the output, or if they need to modify
their R code. Once the LLM does not provide new R code (i.e., the prompt is being answered)
this prompt wrap will end (it will continue for as long as the LLM provides R code).</p></dd>


<dt id="arg-return-mode">return_mode<a class="anchor" aria-label="anchor" href="#arg-return-mode"></a></dt>
<dd><p>Character string indicating the return mode. One of
'full', 'code', 'console', 'object', 'formatted_output', or 'llm_answer'.
If 'full', the function will return a list with the original LLM answer,
the extracted R code, and (if evaluated) the output of the R code.
If 'code', the function will return the extracted R code. If 'console', the
function will return the console output of the evaluated R code.
If 'object', the function will return the object produced by the evaluated R code.
If 'formatted_output', the function will return a formatted string with the
extracted R code, its console output, and a print of the last object (identical
to how it would be presented to the LLM if 'output_as_tool' is TRUE).
If 'llm_answer', 'llm_answer', the function will return only the original LLM answer.
When choosing 'console' or 'object', an additional instruction will be added to
the prompt text to inform the LLM about the expected output of the R code.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A tidyprompt object with the new prompt wrap added to it</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Luka Koning, Tjark Van de Merwe.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

